<%- include('../search_pagination.ejs', { search, currentPage, totalPages }) %>

<% if (fiches.length === 0) { %>
    <p>Vous n'avez pas encore de fiche de poste.</p>
    <p>Vous pouvez en créer une <a href="/jobs/add_job">ici</a>.</p>
<% } %>

<% fiches.forEach((fiche) => { %>
    <div class="card mb-3">
        <div class="card-body">
            <h5 class="card-title"><%= fiche.Intitule %></h5>
            <div class="btn-group" role="group">
                <form method="get" action="/jobs/edit_job">
                    <input type="hidden" name="idFiche" value="<%= fiche.IdFiche %>">
                    <button type="submit" class="btn btn-primary">Editer</button>
                </form>
                <button type="button" class="btn btn-secondary" data-bs-toggle="modal" data-bs-target="#detailsModal<%= fiche.IdFiche %>">Détails</button>
                <button type="button" class="btn btn-danger delete-button" data-id="<%= fiche.IdFiche %>">Supprimer</button>
            </div>
        </div>
    </div>

    <!-- Modal pour les détails de la fiche de poste -->
    <%- include('../modal', {
    modalId: `detailsModal${fiche.IdFiche}`,
    modalLabelId: `detailsModalLabel${fiche.IdFiche}`,
    modalTitle: 'Détails de la Fiche de Poste',
    modalBody: 'jobs/fiche_details.ejs',
    fiche: fiche
    }) %>
<% }); %>

<%- include('../pagination.ejs', { currentPage, totalPages, search }) %>
