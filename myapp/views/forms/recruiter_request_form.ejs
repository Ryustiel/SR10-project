<form id="recruiterRequestForm" method="post" action="/organizations/request-recruiter">
    <input type="hidden" name="userId" value="<%= user.Email %>">
    <div class="mb-3">
        <label for="existingOrganisation" class="form-label">Choisissez une organisation existante</label>
        <select class="form-select" id="existingOrganisation" name="existingOrganisation" required>
            <option value="" selected disabled>SÃ©lectionnez une organisation</option>
            <% organisations.forEach(function(org) { %>
                <option value="<%= org.NumeroSiren %>"><%= org.Nom %> (<%= org.NumeroSiren %>)</option>
            <% }); %>
            <option value="new">Ajouter une nouvelle organisation</option>
        </select>
    </div>
    <div id="newOrganisationFields" class="d-none">
        <div class="mb-3">
            <label for="newOrganisationSiren" class="form-label">SIREN de l'organisation</label>
            <input type="number" class="form-control" id="newOrganisationSiren" name="newOrganisationSiren">
        </div>
        <div class="mb-3">
            <label for="newOrganisationName" class="form-label">Nom de l'organisation</label>
            <input type="text" class="form-control" id="newOrganisationName" name="newOrganisationName">
        </div>
        <div class="mb-3">
            <label for="newOrganisationType" class="form-label">Type de l'organisation</label>
            <input type="text" class="form-control" id="newOrganisationType" name="newOrganisationType">
        </div>
        <div class="mb-3">
            <label for="newOrganisationAddress" class="form-label">Adresse administrative</label>
            <input type="text" class="form-control" id="newOrganisationAddress" name="newOrganisationAddress">
        </div>
    </div>
    <button type="submit" class="btn btn-primary">Envoyer la demande</button>
</form>

<script>
    document.getElementById('existingOrganisation').addEventListener('change', function () {
        const newOrganisationFields = document.getElementById('newOrganisationFields');
        if (this.value === 'new') {
            newOrganisationFields.classList.remove('d-none');
            newOrganisationFields.querySelectorAll('input').forEach(input => input.required = true);
        } else {
            newOrganisationFields.classList.add('d-none');
            newOrganisationFields.querySelectorAll('input').forEach(input => input.required = false);
        }
    });
</script>
