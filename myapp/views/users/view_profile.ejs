<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tableau de Bord</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
</head>
<body>
<%- include("../navbar.ejs") %>
<div class="container my-5">
    <div class="row">
        <div class="col-md-10 offset-md-1">
            <div class="d-flex justify-content-between align-items-center mb-4">
                <h2 class="mb-0">Mon Profil</h2>
                <a href="/logout" class="btn btn-danger">Se déconnecter</a>
            </div>

            <!-- Afficher le message d'erreur s'il existe -->
            <% if (typeof errorMessage !== 'undefined' && errorMessage) { %>
                <div class="alert alert-danger"><%= errorMessage %></div>
            <% } %>

            <div class="card">
                <div class="card-header bg-primary text-white">
                    Profil de : <%= user.Prenom %> <%= user.Nom %>
                </div>
                <div class="card-body">
                    <p class="card-text"><strong>Email :</strong> <%= user.Email %></p>
                    <p class="card-text"><strong>Téléphone :</strong> <%= user.Telephone %></p>
                    <p class="card-text"><strong>Date de création :</strong> <%= new Date(user.DateCreation).toLocaleDateString("fr-FR") %></p>
                    <p class="card-text"><strong>Statut du Compte :</strong> <%= user.StatutCompte %></p>
                    <p class="card-text">
                        <strong>Type de Compte :</strong> <%= user.TypeCompte %>
                        <% if (user.TypeCompte.toLowerCase() === 'candidat') { %>
                            <button class="btn btn-warning" data-bs-toggle="modal" data-bs-target="#requestRecruiterModal">Demander à devenir recruteur</button>
                        <% } else if (user.TypeCompte.toLowerCase() === 'recruteur en attente') { %>
                            <a href="/applications/cancel-recruiter-request" class="btn btn-secondary">Annuler la demande</a>
                        <% } %>
                    </p>
                    <p class="card-text"><strong>Organisation :</strong> <%= user.IdOrganisation %></p>
                </div>
            </div>
            <% if (user.TypeCompte.toLowerCase() === 'administrateur') { %>
                <div class="mt-4">
                    <a href="/applications/manage_requests" class="btn btn-secondary">Gérer les demandes</a>
                </div>
            <% } %>
        </div>
    </div>
</div>
<%- include("../forms/recruiter_request_form.ejs") %>
<%- include("../scripts/profile_scripts.ejs") %>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
